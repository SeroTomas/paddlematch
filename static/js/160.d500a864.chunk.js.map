{"version":3,"file":"static/js/160.d500a864.chunk.js","mappings":"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","sources":["webpack://PaddleMatch/./src/admin/UserManagementPage.module.css?7b7c","admin/UserManagementPage.js"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"wrapper\":\"UserManagementPage_wrapper__W6PE6\",\"spacer\":\"UserManagementPage_spacer__1dVDb\"};","import { Button, Modal, Space, Table, Tooltip } from 'antd';\r\nimport { DeleteOutlined, EditOutlined, ExclamationCircleOutlined, MailOutlined } from '@ant-design/icons';\r\nimport React, { useCallback, useContext, useMemo, useState } from 'react';\r\nimport { deleteUserApi, getUsersApi, patchUserApi } from '../api';\r\n\r\nimport { ErrorResult } from '../ErrorResult';\r\nimport { authContext } from '../AuthContext';\r\nimport styles from './UserManagementPage.module.css';\r\nimport { useApi } from '../useApi';\r\n\r\nexport function UserManagementPage() {\r\n\r\n    const { user: { userId } } = useContext(authContext);\r\n\r\n    const [users, setUsers] = useState([]);\r\n    const [getState,] = useApi(getUsersApi, setUsers, true);\r\n    const [deleteState, deleteUser] = useApi(deleteUserApi, setUsers);\r\n    const [putState, patchUser] = useApi(patchUserApi, setUsers);\r\n\r\n    // key prop is required for antd\r\n    const keyedUsers = useMemo(() => users.map(u => ({ ...u, key: u.userId })), [users]);\r\n\r\n    const handleDeleteUser = useCallback(userId => {\r\n        deleteUser({ path: { userId } }, { userId });\r\n    }, [deleteUser]);\r\n\r\n    const handleSetAdmin = useCallback((userId, admin) => {\r\n        patchUser({ path: { userId } }, {\r\n            userId,\r\n            admin,\r\n        });\r\n    }, [patchUser]);\r\n\r\n    const columns = [\r\n        {\r\n            title: 'UserId',\r\n            dataIndex: 'userId',\r\n            key: 'userId',\r\n            width: '5%',\r\n            sorter: (a, b) => a.userId < b.userId ? -1 : 1,\r\n        },\r\n        {\r\n            title: 'Admin',\r\n            dataIndex: 'admin',\r\n            key: 'admin',\r\n            width: '10%',\r\n            sorter: (a, b) => a.admin === b.admin ? 0 : (a.admin ? -1 : 1),\r\n            render: (_, record) => (\r\n                <div>\r\n                    {record.admin ? \"Si\" : \"No\"}\r\n                    <Tooltip title=\"Cambiar estado de administrador\">\r\n                        <Button\r\n                            disabled={record.userId === userId}\r\n                            type=\"link\"\r\n                            icon={<EditOutlined />}\r\n                            onClick={() => {\r\n                                Modal.confirm({\r\n                                    title: record.admin ? '¿Revocar derechos de administrador?' : '¿Conceder derechos de administrador?',\r\n                                    icon: <ExclamationCircleOutlined />,\r\n                                    content: (\r\n                                        <div>\r\n                                            El usuario\r\n                                            <br />\r\n                                            <strong>{record.name} ({record.mail})</strong>\r\n                                            <br />\r\n                                            será a través de esta acción {record.admin ? 'degradado a un usuario normal.' : 'ascendido a administrador.'}\r\n                                        </div>\r\n                                    ),\r\n                                    okText: record.admin ? 'retirar derechos' : 'Hazte administrador',\r\n                                    okType: 'danger',\r\n                                    cancelText: 'Cancelar',\r\n                                    onOk() {\r\n                                        handleSetAdmin(record.userId, !record.admin);\r\n                                    },\r\n                                });\r\n                            }}\r\n                        />\r\n                    </Tooltip>\r\n                </div>\r\n            )\r\n        },\r\n        {\r\n            title: 'Name',\r\n            dataIndex: 'name',\r\n            key: 'name',\r\n            width: '20%',\r\n            sorter: (a, b) => a.name.localeCompare(b.name),\r\n        },\r\n        {\r\n            title: 'E-Mail',\r\n            dataIndex: 'mail',\r\n            key: 'mail',\r\n            width: '25%',\r\n            sorter: (a, b) => a.mail.localeCompare(b.mail),\r\n        },\r\n        {\r\n            title: 'Verificado',\r\n            dataIndex: 'verified',\r\n            key: 'verified',\r\n            width: '5%',\r\n            sorter: (a, b) => a.verified === b.verified ? 0 : (a.verified ? -1 : 1),\r\n            render: (_, record) => record.verified ? 'Si' : 'No',\r\n        },\r\n        {\r\n            title: 'Última actividad',\r\n            dataIndex: 'lastActivity',\r\n            key: 'lastActivity',\r\n            width: '20%',\r\n            sorter: (a, b) => a.lastActivity - b.lastActivity,\r\n            render: (_, record) => record.lastActivity?.format('L LT'),\r\n        },\r\n        {\r\n            title: 'Reservas (abiertas)',\r\n            dataIndex: 'upcomingReservationCount',\r\n            key: 'upcomingReservationCount',\r\n            width: '5%',\r\n            sorter: (a, b) => a.upcomingReservationCount - b.upcomingReservationCount,\r\n        },\r\n        {\r\n            title: 'Reservas (totales)',\r\n            dataIndex: 'totalReservationCount',\r\n            key: 'totalReservationCount',\r\n            width: '5%',\r\n            sorter: (a, b) => a.totalReservationCount - b.totalReservationCount,\r\n        },\r\n        {\r\n            title: '',\r\n            key: 'action',\r\n            render: (_, record) => (\r\n                <Space key={record._id}>\r\n                    <Tooltip title=\"Enviar correo electrónico\">\r\n                        <Button\r\n                            type=\"link\"\r\n                            icon={<MailOutlined />}\r\n                            disabled={record.userId === userId}\r\n                            onClick={() => {\r\n                                window.location.href = `mailto:${record.mail}`;\r\n                            }}\r\n                        />\r\n                    </Tooltip>\r\n                    <Tooltip title=\"Eliminar usuario\">\r\n                        <Button\r\n                            type=\"link\"\r\n                            danger\r\n                            icon={<DeleteOutlined />}\r\n                            disabled={record.userId === userId}\r\n                            onClick={() => {\r\n                                Modal.confirm({\r\n                                    title: '¿Borrar usuario?',\r\n                                    icon: <ExclamationCircleOutlined />,\r\n                                    content: (\r\n                                        <>\r\n                                            <div>Esta acción no se puede deshacer.</div>\r\n                                            <div>Todos los datos y reservas serán eliminados irrevocablemente.</div>\r\n                                            <br />\r\n                                            <div>\r\n                                                <strong>\r\n                                                    Usuario: {record.name}\r\n                                                    <br />\r\n                                                    E-Mail: {record.mail}\r\n                                                </strong>\r\n                                            </div>\r\n                                        </>\r\n                                    ),\r\n                                    okText: 'Borrar permanentemente',\r\n                                    okType: 'danger',\r\n                                    cancelText: 'Cancelar',\r\n                                    onOk() {\r\n                                        handleDeleteUser(record.userId);\r\n                                    },\r\n                                });\r\n                            }}\r\n                        />\r\n                    </Tooltip>\r\n                </Space>\r\n            ),\r\n        },\r\n    ];\r\n\r\n    if (getState.error || deleteState.error || putState.error)\r\n        return <ErrorResult />\r\n\r\n    return (\r\n        <div className={styles.wrapper}>\r\n            <h1>Gestión de usuarios</h1>\r\n            <Table\r\n                columns={columns}\r\n                dataSource={keyedUsers}\r\n                loading={getState.loading || deleteState.loading || putState.loading}\r\n                scroll={{ x: 1300 }}\r\n            />\r\n        </div>\r\n    )\r\n}"],"names":["UserManagementPage","user","userId","useContext","authContext","users","setUsers","useState","getState","useApi","getUsersApi","deleteState","deleteUser","deleteUserApi","putState","patchUser","patchUserApi","keyedUsers","useMemo","map","u","key","handleDeleteUser","useCallback","path","handleSetAdmin","admin","columns","title","dataIndex","width","sorter","a","b","render","_","record","_jsxs","children","_jsx","Tooltip","Button","disabled","type","icon","EditOutlined","onClick","Modal","confirm","ExclamationCircleOutlined","content","name","mail","okText","okType","cancelText","onOk","localeCompare","verified","lastActivity","_record$lastActivity","format","upcomingReservationCount","totalReservationCount","Space","MailOutlined","window","location","href","concat","danger","DeleteOutlined","_Fragment","_id","error","ErrorResult","className","styles","wrapper","Table","dataSource","loading","scroll","x"],"sourceRoot":""}