"use strict";(self.webpackChunkreservierungssystem_tennis=self.webpackChunkreservierungssystem_tennis||[]).push([[759],{44423:(e,r,a)=>{a.d(r,{l:()=>d});var s=a(35391),o=a(46536);const n={pickerPanel:"DatePicker_pickerPanel__Dny7D"};var t=a(51335),l=a(70579);const i=(0,o.Ay)(s.A);function d(e){return(0,l.jsx)(i,{locale:t.A,inputReadOnly:!0,size:"large",panelRender:e=>(0,l.jsx)("div",{className:n.pickerPanel,children:e}),...e})}},75485:(e,r,a)=>{a.d(r,{N:()=>h});var s=a(53722),o=a(81210),n=a(30119),t=a(42156),l=a(42144),i=(a(65043),a(18465)),d=a.n(i);const c={inline:"ReservationDetails_inline__JDB9T",wrapper:"ReservationDetails_wrapper__L7chI",item:"ReservationDetails_item__JFolP",title:"ReservationDetails_title__HPG5Q",content:"ReservationDetails_content__UVfoF"};var u=a(70579);const v=d().bind(c);function h(e){let{court:r,date:a,inline:i=!1,name:d,repeat:h,time:m}=e;return(0,u.jsxs)("div",{className:v({wrapper:!0,inline:i}),children:[d&&(0,u.jsxs)("div",{className:c.item,children:[(0,u.jsxs)("div",{className:c.title,children:[(0,u.jsx)(s.A,{}),"\xa0Nombre"]}),(0,u.jsx)("div",{className:c.content,children:d})]}),a&&(0,u.jsxs)("div",{className:c.item,children:[(0,u.jsxs)("div",{className:c.title,children:[(0,u.jsx)(o.A,{}),"\xa0Fecha"]}),(0,u.jsx)("div",{className:c.content,children:a})]}),m&&(0,u.jsxs)("div",{className:c.item,children:[(0,u.jsxs)("div",{className:c.title,children:[(0,u.jsx)(n.A,{}),"\xa0Hora"]}),(0,u.jsx)("div",{className:c.content,children:m})]}),r&&(0,u.jsxs)("div",{className:c.item,children:[(0,u.jsxs)("div",{className:c.title,children:[(0,u.jsx)(t.A,{}),"\xa0Lugar"]}),(0,u.jsx)("div",{className:c.content,children:r})]}),h&&(0,u.jsxs)("div",{className:c.item,children:[(0,u.jsxs)("div",{className:c.title,children:[(0,u.jsx)(l.A,{}),"\xa0Repetir"]}),(0,u.jsx)("div",{className:c.content,children:h})]})]})}},80759:(e,r,a)=>{a.d(r,{A:()=>oe});var s=a(65043),o=a(48193),n=a(26032),t=a(89421),l=a(95862),i=a(53593),d=a(25389),c=a(22768),u=a(44423),v=a(28369),h=a(93768);const m={datePicker:"DateTimeRangeSelect_datePicker__+Z4AM",to:"DateTimeRangeSelect_to__kTmUi"};var x=a(70579);function p(e){let{disabled:r=!1,from:a,to:o,onFromChange:n,onToChange:t}=e;const l=(0,s.useMemo)((()=>[...Array(24).keys()]),[]),i=(0,s.useCallback)((e=>{let{newFrom:r=a,newTo:s=o}=e;if(r.isAfter(s)){const e=r;r=s,s=e}else r.isSame(s)&&(s=r.add(1,"hour"));r.isSame(a)||n(r),s.isSame(o)||t(s)}),[a,n,t,o]),d=(0,s.useCallback)((e=>{i({newFrom:e.hour(a.hour())})}),[a,i]),c=(0,s.useCallback)((e=>{i({newTo:e.hour(o.hour())})}),[o,i]),p=(0,s.useCallback)((e=>{i({newFrom:a.hour(e)})}),[a,i]),f=(0,s.useCallback)((e=>{i({newTo:o.hour(e)})}),[o,i]);return(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{children:[(0,x.jsx)(u.l,{allowClear:!1,bordered:!1,className:m.datePicker,disabled:r,format:"L",onChange:d,showToday:!1,suffixIcon:(0,x.jsx)(v.A,{}),value:a}),(0,x.jsx)(h.A,{size:"large",bordered:!1,value:a.hour(),onChange:p,children:l.map((e=>(0,x.jsxs)(h.A.Option,{value:e,children:[e,"hs"]},e)))})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("span",{className:m.to,children:"Hasta"}),(0,x.jsx)(u.l,{allowClear:!1,bordered:!1,className:m.datePicker,disabled:r,format:"L",onChange:c,showToday:!1,suffixIcon:(0,x.jsx)(v.A,{}),value:o}),(0,x.jsx)(h.A,{size:"large",bordered:!1,value:o.hour(),onChange:f,children:l.map((e=>(0,x.jsxs)(h.A.Option,{value:e,children:[e%24,"hs"]},e)))})]})]})}var f=a(52603),j=a(40989),g=a(75485),b=a(18465),C=a.n(b);const A={outer:"ScrollRadioGroup_outer__8Qzxh",inner:"ScrollRadioGroup_inner__wupbG",leftScroll:"ScrollRadioGroup_leftScroll__vDJ5K",rightScroll:"ScrollRadioGroup_rightScroll__zv7QH"},k=C().bind(A),_=-50,R=5;function y(e){let{children:r,...a}=e;const o=(0,s.useRef)(),[n,t]=(0,s.useState)(!1),[i,d]=(0,s.useState)(!1),c=(0,s.useCallback)((()=>{if(!o.current)return;const{scrollLeft:e,scrollWidth:r,offsetWidth:a}=o.current;t(e>R),d(r-a-e>R)}),[]);(0,s.useEffect)(c,[c]);const u=(0,s.useCallback)((e=>{var r,a,s;if(!o.current)return;const n=(null===e||void 0===e||null===(r=e.target)||void 0===r||null===(a=r.parentNode)||void 0===a||null===(s=a.parentNode)||void 0===s?void 0:s.offsetLeft)||0;requestAnimationFrame((()=>{o.current.scrollLeft=Math.max(n+_,0)}))}),[]);return(0,x.jsx)("div",{className:k({outer:!0,leftScroll:n,rightScroll:i}),children:(0,x.jsx)("div",{className:A.inner,onClick:u,onScroll:c,ref:o,children:(0,x.jsx)(l.Ay.Group,{buttonStyle:"solid",size:"large",...a,children:r})})})}var I=a(93954),N=a(17592),S=a(60446),F=a.n(S),w=a(39194);const L={wrapper:"ReservationGroupModal_wrapper__gV8z-",footer:"ReservationGroupModal_footer__xPwiR",heading:"ReservationGroupModal_heading__3Wd3R",changeReasonHint:"ReservationGroupModal_changeReasonHint__Fe8RT",cancelRadioGroup:"ReservationGroupModal_cancelRadioGroup__e+8TH"};var T=a(24095);function B(e){var r,a;let{initialFrom:u,initialCourtId:v,reservation:h,onFinish:m,setReservations:b}=e;const{config:{visibleHours:C},courts:A}=(0,s.useContext)(N.v),[k,_]=(0,s.useState)((null===h||void 0===h?void 0:h.text)||""),[R,S]=(0,s.useState)((()=>(null===h||void 0===h?void 0:h.from)||u.startOf("day"))),[B,E]=(0,s.useState)((()=>(null===h||void 0===h?void 0:h.to)||u.add(1,"day").startOf("day"))),[M,O]=(0,s.useState)((null===h||void 0===h?void 0:h.courtId)||v),G=(0,s.useRef)({}),[P,D]=(0,T.g)(c.AI,b),[z,H]=(0,T.g)(c.iU,b),q=P.loading||z.loading,U=h&&(h.from!==R||h.to!==B||h.text!==k||h.courtId!==M),V=(0,s.useMemo)((()=>{var e,r;let a=(null===(e=P.error)||void 0===e?void 0:e.unavailableReservations)||(null===(r=z.error)||void 0===r?void 0:r.unavailableReservations);return a&&(a=a.map((e=>{let{courtId:r,from:a,to:s}=e;return{courtId:r,from:F()(a),to:F()(s)}}))),a}),[null===(r=z.error)||void 0===r?void 0:r.unavailableReservations,null===(a=P.error)||void 0===a?void 0:a.unavailableReservations]),W=(0,s.useCallback)((e=>{_(e.target.value)}),[]),Q=(0,s.useCallback)((e=>{O(e.target.value)}),[]),Y=(0,s.useCallback)((()=>{var e;const r=()=>{h?H({path:{groupId:h.groupId}},{reservations:[{courtId:M,from:R,to:B}],text:k},(()=>{o.Ay.success("Reserva exitosa"),m()})):D(null,{reservations:[{courtId:M,from:R,to:B}],text:k,type:j.P.DISABLE},(()=>{o.Ay.success("Reserva exitosa"),m()}))};let a;R.hour()<=C[0]?a=R.hour(C[0]):R.hour()>=C[1]&&(a=R.add(1,"day").hour(C[0])),null!==(e=a)&&void 0!==e&&e.isSameOrAfter(B,"hour")?n.A.error({icon:!1,title:"Reserva no permitida",width:530,centered:!0,content:"El Reserva est\xe1 fuera del per\xedodo mostrado."}):n.A.confirm({icon:!1,title:"\xbfRealmente bloquear?",okText:"Sperren",okType:"danger",width:530,centered:!0,content:"Las reservas existentes que entren en conflicto con el bloqueo ser\xe1n canceladas autom\xe1ticamente. Los titulares de las reservas ser\xe1n informados de ello v\xeda correo electr\xf3nico.",onOk:r})}),[M,R,m,H,D,k,h,B,C]),Z=(0,s.useCallback)((()=>{H({path:{groupId:h.groupId}},{reservations:[]},(()=>{o.Ay.success("Bloqueo levantado"),m()}))}),[m,H,null===h||void 0===h?void 0:h.groupId]);return(0,s.useEffect)((()=>{G.current.post===P.error&&G.current.patch===z.error||(G.current.post=P.error,G.current.patch=z.error,V&&n.A.error({centered:!0,title:"Error de bloqueo",content:(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{children:"Ya existe un bloqueo para los siguientes periodos:"}),(0,x.jsx)("ul",{children:V.map((e=>{let{courtId:r,from:a,to:s}=e;return(0,x.jsxs)("li",{children:[a.format("dd[\xa0]L,[\xa0]H[\xa0][Uhr]")," bis ",s.format("dd[\xa0]L,[\xa0]H[\xa0][Uhr]"),", ",(0,w.B4)(A,r)]},a)}))})]})}))}),[A,z.error,P.error,V]),P.error&&!P.error.unavailableReservations||z.error&&!z.error.unavailableReservations?(0,x.jsx)(n.A,{title:"Error de bloqueo",visible:!0,centered:!0,onCancel:m,onOk:m,footer:(0,x.jsx)("div",{className:L.footer,children:(0,x.jsx)(t.A,{onClick:m,children:"Cancelar"})}),children:(0,x.jsx)("div",{className:L.wrapper,children:(0,x.jsx)(f.Y,{})})}):(0,x.jsx)(n.A,{title:"Espacio de bloque",visible:!0,width:530,centered:!0,onCancel:m,onOk:m,footer:q?(0,x.jsx)(I.E,{loading:!0,text:"Espere por favor..."}):(0,x.jsxs)("div",{className:L.footer,children:[(0,x.jsx)(t.A,{onClick:m,children:"Cancelar"}),h&&(0,x.jsx)(t.A,{type:"primary",onClick:Z,children:"Eliminar bloqueo"}),(0,x.jsx)(t.A,{disabled:h&&!U,type:"danger",onClick:Y,children:"Bloqueo"})]}),children:(0,x.jsxs)("div",{className:L.wrapper,children:[(0,x.jsx)(g.N,{court:(0,x.jsx)(y,{disabled:q,onChange:Q,value:M,children:A.map((e=>{let{courtId:r,name:a}=e;return(0,x.jsx)(l.Ay.Button,{value:r,children:a},r)}))}),date:(0,x.jsx)(p,{disabled:q,from:R,to:B,onFromChange:S,onToChange:E})}),(0,x.jsx)(i.A,{layout:"vertical",children:(0,x.jsxs)(i.A.Item,{label:"Grund der Sperrung",children:[(0,x.jsx)(d.A,{disabled:q,onChange:W,placeholder:"Kein Grund",value:k}),(0,x.jsx)("div",{className:L.changeReasonHint,children:"Las reservas existentes ser\xe1n canceladas."})]})})]})})}var E=a(86565);function M(e){let{onClose:r}=e;return(0,x.jsx)(n.A,{title:"Se requiere inicio de sesion",visible:!0,width:400,centered:!0,onCancel:r,onOk:r,footer:null,children:(0,x.jsx)(E.Q,{})})}var O=a(24700),G=a(39470),P=a(67407),D=a(98617),z=a(61966),H=a(75337),q=a(49613);const U={wrapper:"RepeatReservationForm_wrapper__6cPkD",dates:"RepeatReservationForm_dates__mG3c+",extra:"RepeatReservationForm_extra__BTnTX",unchecked:"RepeatReservationForm_unchecked__QU-hA",date:"RepeatReservationForm_date__7rG8Y",dateButton:"RepeatReservationForm_dateButton__LqRko",danger:"RepeatReservationForm_danger__2R860",buttons:"RepeatReservationForm_buttons__izWaj"};var V=a(60665);const W=C().bind(U),Q={1:"Diario",7:"Semanal",14:"Bi-Semanal"};function Y(e){let{courtId:r,currentReservations:a,defaultAddCount:o=2,disabled:n=!1,from:i,onChange:d,repeatValuesMap:c=Q,to:u,unavailableReservations:v}=e;const{user:h}=(0,s.useContext)(q.I),{config:{reservationDaysInAdvance:m}}=(0,s.useContext)(N.v),p=(0,V.z)("hour"),[f,j]=(0,s.useState)(0),[g,b]=(0,s.useState)([]),[C,A]=(0,s.useState)([]),k=(0,s.useRef)({}),_=(0,s.useCallback)((e=>({courtId:r,from:e,to:e.hour(u.hour()||24)})),[r,u]),R=(0,s.useCallback)((e=>!(null!==h&&void 0!==h&&h.admin)&&e.isAfter(p.add(m,"day"),"day")),[p,m,null===h||void 0===h?void 0:h.admin]),I=(0,s.useCallback)((e=>{if(!v)return!1;const r=_(e);return v.some((e=>r.courtId===e.courtId&&r.from.isSame(e.from,"hour")&&r.to.isSame(e.to,"hour")))}),[v,_]),S=(0,s.useCallback)((e=>{A((r=>{let a=e;return"function"===typeof e&&(a=e(r)),a.filter((e=>!I(e)&&!R(e)))}))}),[I,R]);(0,s.useEffect)((()=>{d(C.map(_))}),[C,d,_]),(0,s.useEffect)((()=>S((e=>e))),[S]);const F=(0,s.useCallback)((()=>{let e=[],r=[];if((null===a||void 0===a?void 0:a.length)>1){e=a.map((e=>e.from.hour(i.hour()))),e.sort(((e,r)=>e.valueOf()-r.valueOf()));let s=Number.MAX_SAFE_INTEGER;if(e.length>1)for(let r=1;r<e.length;++r){const a=e[r-1].diff(e[r],"day");s=Math.min(s,Math.abs(a))}s=s.toString();const o=Object.keys(c);o.includes(s)||(s=o[0]),j(s);const n=e[0],t=e[e.length-1],l=Math.abs(n.diff(t,"day")/s);r=[];for(let e=0;e<=l;++e)r.push(n.add(e*s,"day"))}else if(f>0)for(let a=0;a<=o;++a){const s=i.add(a*f,"day");r.push(s),e.push(s)}else e=[i],r=[i];b(r),S(e)}),[a,o,i,f,c,S]);(0,s.useEffect)((()=>{k.current.courtId===r&&k.current.currentReservations===a&&k.current.from===i&&k.current.repeatValue===f&&k.current.to===u||(k.current.courtId=r,k.current.currentReservations=a,k.current.from=i,k.current.repeatValue=f,k.current.to=u,F())}),[r,a,i,f,F,u]);const w=(0,s.useCallback)((()=>{b((e=>{const r=e[e.length-1].add(f,"day");return S((e=>[...e,r])),[...e,r]}))}),[f,S]),L=(0,s.useCallback)((e=>{const r=e.target.value;j(r)}),[]),T=(0,s.useCallback)(((e,r)=>{S((a=>{const s=a.filter((r=>!r.isSame(e,"day")));return r&&s.push(e),s.sort(((e,r)=>e.valueOf()-r.valueOf())),s}))}),[S]),B=(0,s.useMemo)((()=>g.map((e=>{const r=_(e),s=null===a||void 0===a?void 0:a.some((e=>e.from.isSame(r.from,"hour")&&e.to.isSame(r.to,"hour"))),o=C.some((r=>r.isSame(e,"day")));return{date:e,checked:o,change:!s&&(null===a||void 0===a?void 0:a.some((r=>r.from.isSame(e,"day")))),reserved:s,past:e.isBefore(p,"hour"),notAvailable:I(e),tooFarAhead:R(e),onClick:()=>T(e,!o)}}))),[I,R,a,_,T,p,C,g]);return(0,x.jsxs)("div",{className:U.wrapper,children:[(0,x.jsx)("div",{children:(0,x.jsxs)(y,{disabled:(null===a||void 0===a?void 0:a.length)>1||n,onChange:L,value:f,children:[(0,x.jsx)(l.Ay.Button,{value:0,children:"Hoy"},0),Object.keys(c).map((e=>(0,x.jsx)(l.Ay.Button,{value:e,children:c[e]},e)))]})}),f>0&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:U.dates,children:B.map((e=>{let{date:r,checked:a,change:s,reserved:o,past:l,notAvailable:i,tooFarAhead:d,onClick:c}=e;return(0,x.jsxs)(t.A,{className:W({dateButton:!0,unchecked:!a,danger:o&&!a||i}),disabled:!(null!==h&&void 0!==h&&h.admin)&&(l||d)||i||n,onClick:c,type:"link",icon:(null===h||void 0===h||!h.admin)&&(l||d)||i||n?(0,x.jsx)(D.A,{}):a?(0,x.jsx)(z.A,{}):(0,x.jsx)(H.A,{}),children:[(0,x.jsx)("span",{className:U.date,children:r.format("dd[\xa0]L")}),!l&&o&&a&&(0,x.jsx)("span",{className:U.extra,children:"Aktuell reserviert"}),!l&&o&&!a&&(0,x.jsx)("span",{className:U.extra,children:"Wird storniert"}),!i&&l&&(0,x.jsx)("span",{className:U.extra,children:"Bereits vergangen"}),!i&&d&&(0,x.jsx)("span",{className:U.extra,children:"Zu weit in der Zukunft"}),!i&&s&&(0,x.jsx)("span",{className:U.extra,children:"Wird ge\xe4ndert"}),i&&(0,x.jsx)("span",{className:U.extra,children:"Nicht verf\xfcgbar"})]},r)}))}),(0,x.jsx)("div",{className:U.buttons,children:(0,x.jsx)(t.A,{disabled:n,icon:(0,x.jsx)(H.A,{}),onClick:w,type:"dashed"})})]})]})}var Z=a(64435);function J(e){let{disabled:r=!1,from:a,to:o,onFromChange:n,onToChange:t}=e;const{config:{visibleHours:l}}=(0,s.useContext)(N.v),i=(0,s.useMemo)((()=>(0,w.XD)(l)),[l]),d=(0,s.useMemo)((()=>i.reduce(((e,r)=>(r>=a.hour()&&e.push(r+1),e)),[])),[a,i]);(0,s.useEffect)((()=>{a.isSame(o,"hour")&&t(a.add(1,"hour"))}),[a,o,t]);const c=(0,s.useCallback)((e=>{let r=e+Math.abs(o.diff(a,"hour"));i.includes(r)||(r=i[i.length-1]+1),n(a.hour(e)),t(a.hour(r))}),[a,o,n,t,i]),u=(0,s.useCallback)((e=>{t(a.hour(e))}),[a,t]);return(0,x.jsxs)(Z.A,{direction:"horizontal",size:"middle",children:[(0,x.jsx)(h.A,{bordered:!1,disabled:r,onChange:c,size:"large",value:a.hour(),children:i.map((e=>(0,x.jsxs)(h.A.Option,{value:e,children:[e,"hs"]},e)))}),(0,x.jsx)("span",{children:"hasta"}),(0,x.jsx)(h.A,{bordered:!1,disabled:r,onChange:u,size:"large",value:0===o.hour()?24:o.hour(),children:d.map((e=>(0,x.jsxs)(h.A.Option,{value:e,children:[e%24,"hs"]},e)))})]})}const X={nameInput:"ReservationDetailsForm_nameInput__Gflgg",plain:"ReservationDetailsForm_plain__z3HZR",datePicker:"ReservationDetailsForm_datePicker__YehYU"};function K(e){var r,a,o,n;let{courtId:i,currentReservations:c,disabled:h,from:m,onCourtIdChange:p,onFromChange:f,onReservationsChange:j,onTextChange:b,onToChange:C,readOnly:A,text:k,to:_,unavailableReservations:R}=e;const{courts:I}=(0,s.useContext)(N.v),{user:S}=(0,s.useContext)(q.I),[F,L]=(0,s.useState)(!1),T=(0,s.useCallback)((()=>{L(!0)}),[]),B=(0,s.useCallback)((()=>{L(!1),b(null)}),[b]),E=(0,s.useCallback)((e=>{const r=Math.abs(_.diff(m,"hour")),a=e.hour(m.hour()),s=a.add(r,"hour");f(a),C(s)}),[m,_,f,C]),M=(0,s.useCallback)((e=>{b(e.target.value)}),[b]),O=(0,s.useCallback)((e=>{p(e.target.value)}),[p]);return A?(0,x.jsx)(g.N,{court:(0,x.jsx)("div",{className:X.plain,children:(0,w.B4)(I,i)}),date:(0,x.jsx)("div",{className:X.plain,children:m.format("dd[\xa0]L")}),time:(0,x.jsxs)("div",{className:X.plain,children:[m.format("H")," hs hasta ",_.format("H")," hs"]}),name:(0,x.jsx)("div",{className:X.plain,children:(null===c||void 0===c||null===(r=c[0])||void 0===r?void 0:r.text)||(null===c||void 0===c||null===(a=c[0])||void 0===a?void 0:a.name)||S.name})}):(0,x.jsx)(g.N,{court:(0,x.jsx)(y,{disabled:h,onChange:O,value:i,children:I.map((e=>{let{courtId:r,name:a}=e;return(0,x.jsx)(l.Ay.Button,{value:r,children:a},r)}))}),date:(0,x.jsx)(u.l,{allowClear:!1,bordered:!1,className:X.datePicker,disabled:(null===c||void 0===c?void 0:c.length)>1||h,format:"L",onChange:E,showToday:!1,suffixIcon:(0,x.jsx)(v.A,{}),value:m}),time:(0,x.jsx)(J,{disabled:h,from:m,to:_,onFromChange:f,onToChange:C}),name:F?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(d.A,{className:X.nameInput,disabled:h,onChange:M,placeholder:"z.B. Training, ...",value:k,size:"large"}),(0,x.jsx)(t.A,{disabled:h,onClick:B,type:"link",children:"Cancelar"})]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:X.plain,children:(0,x.jsx)("span",{children:(null===c||void 0===c||null===(o=c[0])||void 0===o?void 0:o.text)||(null===c||void 0===c||null===(n=c[0])||void 0===n?void 0:n.name)||S.name})}),S.admin&&(0,x.jsxs)(t.A,{disabled:h,onClick:T,type:"link",children:[(0,x.jsx)(P.A,{})," editar"]})]}),repeat:(0,x.jsx)(Y,{courtId:i,currentReservations:c,disabled:h,from:m,onChange:j,to:_,unavailableReservations:R})})}function $(e){var r,a;let{initialCourtId:u,initialFrom:v,initialTo:h,reservation:m,onFinish:p,setReservations:g}=e;const{courts:b,templates:{reservationTos:C}}=(0,s.useContext)(N.v),{user:A}=(0,s.useContext)(q.I),[k,_]=(0,s.useState)(""),[R,y]=(0,s.useState)(null),[S,B]=(0,s.useState)(null),[E,M]=(0,s.useState)((null===m||void 0===m?void 0:m.from)||v),[P,D]=(0,s.useState)((null===m||void 0===m?void 0:m.to)||h),[z,H]=(0,s.useState)((null===m||void 0===m?void 0:m.courtId)||u),U=(0,s.useRef)({}),[V,W]=(0,s.useState)([]),[Q,Y]=(0,T.g)(c.Mf,W),[Z,J]=(0,T.g)(c.AI,g),[X,$]=(0,T.g)(c.iU,g),ee=Q.loading||Z.loading||X.loading,re=m&&A.admin&&(null===m||void 0===m?void 0:m.userId)!==A.userId,ae=A.admin||!m||m.userId===A.userId,se=(0,s.useMemo)((()=>null===S||void 0===S?void 0:S.filter((e=>!V.some((r=>r.from.isSame(e.from,"hour")&&r.to.isSame(e.to,"hour")))))),[S,V]),oe=(0,s.useMemo)((()=>S&&V.filter((e=>!S.some((r=>r.from.isSame(e.from,"hour")&&r.to.isSame(e.to,"hour")))))),[S,V]),ne=!(!V||!R),te=(0,s.useMemo)((()=>{var e,r;let a=(null===(e=Z.error)||void 0===e?void 0:e.unavailableReservations)||(null===(r=X.error)||void 0===r?void 0:r.unavailableReservations);return a&&(a=a.map((e=>{let{courtId:r,from:a,to:s}=e;return{courtId:r,from:F()(a),to:F()(s)}}))),a}),[null===(r=X.error)||void 0===r?void 0:r.unavailableReservations,null===(a=Z.error)||void 0===a?void 0:a.unavailableReservations]);(0,s.useEffect)((()=>{null!==m&&void 0!==m&&m.groupId&&Y({query:{"group-id":null===m||void 0===m?void 0:m.groupId}})}),[m,Y]);const le=(0,s.useCallback)((e=>{_(e.target.value)}),[]),ie=(0,s.useCallback)((()=>{n.A.confirm({icon:!1,okText:"Aceptar",width:530,centered:!0,content:(0,x.jsx)("div",{dangerouslySetInnerHTML:{__html:C.body}}),onOk:()=>{J(null,{reservations:S,text:R,type:j.P.NORMAL},(()=>{o.Ay.success("Reserva exitosa"),p()}))}})}),[p,J,S,C,R]),de=(0,s.useCallback)((()=>{n.A.confirm({title:"\xbfRealmente quiere guardar?",icon:(0,x.jsx)(G.A,{}),centered:!0,content:(0,x.jsxs)("div",{className:L.wrapper,children:[se.length>0&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:L.heading,children:"Nuevas fechas"}),(0,x.jsx)("ul",{children:se.map((e=>{let{courtId:r,from:a,to:s}=e;return(0,x.jsxs)("li",{children:[a.format("dd[\xa0]L"),", ",a.hour(),"\xa0bis\xa0",s.hour(),"\xa0hs, ",(0,w.B4)(b,r)]},a)}))})]}),oe.length>0&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:L.heading,children:"Cancelar"}),(0,x.jsx)("ul",{children:oe.map((e=>{let{courtId:r,from:a,to:s}=e;return(0,x.jsxs)("li",{children:[a.format("dd[\xa0]L"),", ",a.hour(),"\xa0bis\xa0",s.hour(),"\xa0hs, ",(0,w.B4)(b,r)]},a)}))})]}),ne&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:L.heading,children:"Cambios"}),(0,x.jsx)("ul",{children:(0,x.jsxs)("li",{children:["Name: ",(0,x.jsx)("strong",{children:R})]})})]})]}),okText:"Confirmar",okType:"danger",cancelText:"Cancelar",onOk:()=>{$({path:{groupId:m.groupId}},{reason:re?k:void 0,reservations:S,text:R},(()=>{o.Ay.success("Guardado con \xe9xito"),p()}))}})}),[re,oe,k,ne,b,se,p,$,m,S,R]),ce=(0,s.useCallback)((()=>{let e="single";const r=r=>e=r.target.value,a=()=>{const r={path:{groupId:m.groupId}};let a;a="single"===e?V.filter((e=>!e.from.isSame(m.from,"day"))):"allActive"===e?V.filter((e=>e.from.isBefore(F()(),"hour"))):[],$(r,{reason:re?k:void 0,reservations:a},(()=>{o.Ay.success("Cancelaci\xf3n exitosa"),p()}))};V.length<=1?a():n.A.confirm({title:"Cancelar citas",icon:(0,x.jsx)(G.A,{}),centered:!0,content:(0,x.jsxs)(l.Ay.Group,{className:L.cancelRadioGroup,onChange:r,defaultValue:e,children:[(0,x.jsx)(l.Ay,{value:"single",children:"solo esta cita"}),(0,x.jsx)("ul",{children:(0,x.jsxs)("li",{children:[m.from.format("dd[\xa0]L"),", ",m.from.hour(),"\xa0bis\xa0",m.to.hour(),"\xa0hs, ",(0,w.B4)(b,m.courtId)]},m.from)}),(0,x.jsx)(l.Ay,{value:"allActive",children:"Todas las citas abiertas"}),(0,x.jsx)("ul",{children:V.filter((e=>!e.from.isBefore(F()(),"hour"))).map((e=>{let{courtId:r,from:a,to:s}=e;return(0,x.jsxs)("li",{children:[a.format("dd[\xa0]L"),", ",a.hour(),"\xa0bis\xa0",s.hour(),"\xa0hs, ",(0,w.B4)(b,r)]},a)}))}),(null===A||void 0===A?void 0:A.admin)&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(l.Ay,{value:"all",children:"Todas las citas"}),(0,x.jsx)("ul",{children:V.map((e=>{let{courtId:r,from:a,to:s}=e;return(0,x.jsxs)("li",{children:[a.format("dd[\xa0]L"),", ",a.hour(),"\xa0bis\xa0",s.hour(),"\xa0hs, ",(0,w.B4)(b,r)]},a)}))})]})]}),okText:"Aceptar",okType:"danger",cancelText:"Cancelar",onOk:a})}),[re,k,b,V,p,$,m,null===A||void 0===A?void 0:A.admin]);return(0,s.useEffect)((()=>{var e,r;if(U.current.post===Z.error&&U.current.patch===X.error)return;U.current.post=Z.error,U.current.patch=X.error;const a=(null===(e=Z.error)||void 0===e?void 0:e.message)||(null===(r=X.error)||void 0===r?void 0:r.message);if(te)n.A.error({centered:!0,title:"Reserva fallida",content:(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{children:"Las siguientes fechas no est\xe1n disponibles:"}),(0,x.jsx)("ul",{children:te.map((e=>{let{courtId:r,from:a,to:s}=e;return(0,x.jsxs)("li",{children:[a.format("dd[\xa0]L"),", ",a.hour(),"\xa0bis\xa0",s.hour(),"\xa0hs, ",(0,w.B4)(b,r)]},a)}))})]})});else if("too many active reservations"===a){var s,o,t,l;const e=(null===(s=Z.error)||void 0===s?void 0:s.value)||(null===(o=X.error)||void 0===o?void 0:o.value),r=(null===(t=Z.error)||void 0===t?void 0:t.max)||(null===(l=X.error)||void 0===l?void 0:l.max),a=Math.abs(e-r);n.A.error({centered:!0,title:"L\xedmite de reserva alcanzado",content:(0,x.jsxs)("div",{children:[(null===S||void 0===S?void 0:S.length)>a?(0,x.jsxs)("p",{children:["Por favor elimine al menos",(0,x.jsx)("strong",{children:a})," Eventos."]}):(0,x.jsx)("p",{children:"Actualmente no puede reservar m\xe1s citas."}),(0,x.jsxs)("p",{children:["Pueden ser un maximo de ",r," Las reservas deben hacerse con anticipaci\xf3n. No se tendr\xe1n en cuenta las citas anteriores."]})]})})}}),[b,null===S||void 0===S?void 0:S.length,Z.error,X.error,te]),Q.error||Z.error&&!Z.error.unavailableReservations&&"too many active reservations"!==Z.error.message||X.error&&!X.error.unavailableReservations&&"too many active reservations"!==X.error.message?(0,x.jsx)(n.A,{title:"reserva",visible:!0,centered:!0,onCancel:p,onOk:p,footer:(0,x.jsx)("div",{className:L.footer,children:(0,x.jsx)(t.A,{onClick:p,children:"Cancelar"})}),children:(0,x.jsx)("div",{className:L.wrapper,children:(0,x.jsx)(f.Y,{})})}):(0,x.jsx)(n.A,{visible:!0,width:530,centered:!0,onCancel:p,onOk:p,footer:ee?(0,x.jsx)(I.E,{loading:!0,text:"Espere por favor..."}):(0,x.jsxs)("div",{className:L.footer,children:[(0,x.jsx)(t.A,{onClick:p,children:"Cerrar"}),ae&&(m?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(t.A,{type:"danger",onClick:ce,disabled:re&&!k,children:"Cancelar reserva"}),(0,x.jsx)(t.A,{type:"primary",onClick:de,disabled:!(null!==se&&void 0!==se&&se.length||null!==oe&&void 0!==oe&&oe.length||ne)||re&&!k,children:"Guardar"})]}):(0,x.jsx)(t.A,{disabled:!(null!==se&&void 0!==se&&se.length),type:"primary",onClick:ie,children:"Reservas"}))]}),children:(0,x.jsxs)("div",{className:L.wrapper,children:[Q.loading?(0,x.jsx)(O.c,{visible:!0,spin:!0,centered:!0,large:!0}):(0,x.jsx)(K,{courtId:z,currentReservations:V,disabled:ee,from:E,onCourtIdChange:H,onFromChange:M,onReservationsChange:B,onTextChange:y,onToChange:D,readOnly:!ae,text:R,to:P,unavailableReservations:te}),re&&(0,x.jsx)(i.A,{layout:"vertical",children:(0,x.jsxs)(i.A.Item,{label:"La razon del cambio",required:!0,children:[(0,x.jsx)(d.A.TextArea,{autoSize:!0,disabled:ee,onChange:le,placeholder:"Necesario",required:!0,value:k}),(0,x.jsx)("div",{className:L.changeReasonHint,children:"El titular de la reserva ser\xe1 informado de los cambios y el motivo de los mismos mediante correo electr\xf3nico."})]})})]})})}var ee=a(13159);const re={buttons:"VerifyMailModal_buttons__Do7oH"};var ae=a(59557);function se(e){let{onClose:r}=e;const{user:a}=(0,s.useContext)(q.I),o=(0,ae.W6)(),l=(0,s.useCallback)((()=>{o.push("/profile")}),[o]),i=(0,s.useCallback)((()=>{o.push("/verify-mail/send")}),[o]);return(0,x.jsx)(n.A,{title:"Correo electr\xf3nico no verificado",visible:!0,centered:!0,width:580,onCancel:r,onOk:r,footer:null,children:(0,x.jsx)(ee.Ay,{status:"warning",title:"Por favor confirme su direcci\xf3n de correo electr\xf3nico",extra:(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{children:["Haga clic en el enlace de confirmaci\xf3n enviado al correo ",(0,x.jsx)("strong",{children:null===a||void 0===a?void 0:a.mail})]}),(0,x.jsxs)("div",{className:re.buttons,children:[(0,x.jsx)(t.A,{type:"primary",onClick:i,children:"Reenviar enlace de confirmaci\xf3n"}),(0,x.jsx)(t.A,{type:"link",onClick:l,children:"Cambiar direcci\xf3n de correo electr\xf3nico"})]})]})})})}function oe(e){const{user:r}=(0,s.useContext)(q.I),{onFinish:a,reservation:o,type:n}=e;return r?r.verified?(null===o||void 0===o?void 0:o.type)===j.P.DISABLE||n===j.P.DISABLE?(0,x.jsx)(B,{...e}):(0,x.jsx)($,{...e}):(0,x.jsx)(se,{onClose:a}):(0,x.jsx)(M,{onClose:a})}},60665:(e,r,a)=>{a.d(r,{z:()=>l});var s=a(65043),o=a(60446),n=a.n(o);const t=6e4;function l(e){const[r,a]=(0,s.useState)((()=>n().tz()));return(0,s.useEffect)((()=>{const s=setInterval((()=>{const s=n().tz();r.isSame(s,e)||a(s)}),t);return()=>clearInterval(s)}),[r,e]),r}},86565:(e,r,a)=>{a.d(r,{Q:()=>j});var s=a(53593),o=a(92135),n=a(25389),t=a(78186),l=a(89421),i=a(75388),d=a(98617),c=a(65043),u=a(62582),v=a(93954),h=a(49613),m=a(22768);const x={loginButton:"LoginForm_loginButton__HopC2",forgotLink:"LoginForm_forgotLink__jgWH-",registerItem:"LoginForm_registerItem__+3yyV"};var p=a(24095),f=a(70579);function j(){const{autoLoginState:e,setUser:r,setRememberLogin:a}=(0,c.useContext)(h.I),[j,g]=(0,p.g)(m.cx,r),b=j.loading||e.loading,C=j.error?"error":void 0,A=(0,c.useCallback)((e=>{let{mail:r,password:s,rememberLogin:o}=e;a(o),g(null,{type:"plain",mail:r,password:s})}),[g,a]);return(0,f.jsxs)(s.A,{layout:"vertical",onFinish:A,children:[j.error&&(0,f.jsx)(s.A.Item,{children:(0,f.jsx)(o.A,{type:"error",message:"Error en el inicio de sesion."})}),(0,f.jsx)(s.A.Item,{name:"mail",rules:[{required:!0,message:"El correo electr\xf3nico es requerido"}],validateStatus:C,children:(0,f.jsx)(n.A,{autoComplete:"email",prefix:(0,f.jsx)(i.A,{style:{color:"#aaa"}}),placeholder:"Correo electr\xf3nico",disabled:b})}),(0,f.jsx)(s.A.Item,{name:"password",rules:[{required:!0,message:"La contrase\xf1a es requerida"}],validateStatus:C,children:(0,f.jsx)(n.A.Password,{autoComplete:"current-password",prefix:(0,f.jsx)(d.A,{style:{color:"#aaa"}}),placeholder:"Contrase\xf1a",disabled:b})}),(0,f.jsxs)(s.A.Item,{children:[(0,f.jsx)(s.A.Item,{name:"rememberLogin",valuePropName:"checked",noStyle:!0,children:(0,f.jsx)(t.A,{disabled:b,children:"Recordar contrase\xf1a"})}),(0,f.jsx)(u.N_,{className:x.forgotLink,to:"/reset-password",children:"Olvid\xe9 mi contrase\xf1a"})]}),(0,f.jsx)(s.A.Item,{children:(0,f.jsx)(l.A,{type:"primary",htmlType:"submit",className:x.loginButton,disabled:b,children:(0,f.jsx)(v.E,{loading:b,text:b?"Iniciando...":"Iniciar sesion"})})}),(0,f.jsx)(s.A.Item,{className:x.registerItem,children:(0,f.jsx)(u.N_,{to:"/register",children:"Registrarse gratis"})})]})}}}]);
//# sourceMappingURL=759.40d8533e.chunk.js.map