"use strict";(self.webpackChunkPaddleMatch=self.webpackChunkPaddleMatch||[]).push([[759],{44423:(e,r,a)=>{a.d(r,{l:()=>d});var o=a(35391),s=a(46536);const n={pickerPanel:"DatePicker_pickerPanel__hDpPj"};var t=a(51335),l=a(70579);const i=(0,s.Ay)(o.A);function d(e){return(0,l.jsx)(i,{locale:t.A,inputReadOnly:!0,size:"large",panelRender:e=>(0,l.jsx)("div",{className:n.pickerPanel,children:e}),...e})}},75485:(e,r,a)=>{a.d(r,{N:()=>h});var o=a(53722),s=a(81210),n=a(30119),t=a(42156),l=a(42144),i=(a(65043),a(18465)),d=a.n(i);const c={inline:"ReservationDetails_inline__JMObT",wrapper:"ReservationDetails_wrapper__E3QzZ",item:"ReservationDetails_item__21QTc",title:"ReservationDetails_title__P3OaT",content:"ReservationDetails_content__GDKWj"};var u=a(70579);const v=d().bind(c);function h(e){let{court:r,date:a,inline:i=!1,name:d,repeat:h,time:m}=e;return(0,u.jsxs)("div",{className:v({wrapper:!0,inline:i}),children:[d&&(0,u.jsxs)("div",{className:c.item,children:[(0,u.jsxs)("div",{className:c.title,children:[(0,u.jsx)(o.A,{}),"\xa0Nombre"]}),(0,u.jsx)("div",{className:c.content,children:d})]}),a&&(0,u.jsxs)("div",{className:c.item,children:[(0,u.jsxs)("div",{className:c.title,children:[(0,u.jsx)(s.A,{}),"\xa0Fecha"]}),(0,u.jsx)("div",{className:c.content,children:a})]}),m&&(0,u.jsxs)("div",{className:c.item,children:[(0,u.jsxs)("div",{className:c.title,children:[(0,u.jsx)(n.A,{}),"\xa0Hora"]}),(0,u.jsx)("div",{className:c.content,children:m})]}),r&&(0,u.jsxs)("div",{className:c.item,children:[(0,u.jsxs)("div",{className:c.title,children:[(0,u.jsx)(t.A,{}),"\xa0Lugar"]}),(0,u.jsx)("div",{className:c.content,children:r})]}),h&&(0,u.jsxs)("div",{className:c.item,children:[(0,u.jsxs)("div",{className:c.title,children:[(0,u.jsx)(l.A,{}),"\xa0Repetir"]}),(0,u.jsx)("div",{className:c.content,children:h})]})]})}},80759:(e,r,a)=>{a.d(r,{A:()=>se});var o=a(65043),s=a(48193),n=a(26032),t=a(89421),l=a(95862),i=a(53593),d=a(25389),c=a(22768),u=a(44423),v=a(28369),h=a(93768);const m={datePicker:"DateTimeRangeSelect_datePicker__HfmHA",to:"DateTimeRangeSelect_to__1R5G3"};var x=a(70579);function p(e){let{disabled:r=!1,from:a,to:s,onFromChange:n,onToChange:t}=e;const l=(0,o.useMemo)((()=>[...Array(24).keys()]),[]),i=(0,o.useCallback)((e=>{let{newFrom:r=a,newTo:o=s}=e;if(r.isAfter(o)){const e=r;r=o,o=e}else r.isSame(o)&&(o=r.add(1,"hour"));r.isSame(a)||n(r),o.isSame(s)||t(o)}),[a,n,t,s]),d=(0,o.useCallback)((e=>{i({newFrom:e.hour(a.hour())})}),[a,i]),c=(0,o.useCallback)((e=>{i({newTo:e.hour(s.hour())})}),[s,i]),p=(0,o.useCallback)((e=>{i({newFrom:a.hour(e)})}),[a,i]),f=(0,o.useCallback)((e=>{i({newTo:s.hour(e)})}),[s,i]);return(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{children:[(0,x.jsx)(u.l,{allowClear:!1,bordered:!1,className:m.datePicker,disabled:r,format:"L",onChange:d,showToday:!1,suffixIcon:(0,x.jsx)(v.A,{}),value:a}),(0,x.jsx)(h.A,{size:"large",bordered:!1,value:a.hour(),onChange:p,children:l.map((e=>(0,x.jsxs)(h.A.Option,{value:e,children:[e,"hs"]},e)))})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("span",{className:m.to,children:"Hasta"}),(0,x.jsx)(u.l,{allowClear:!1,bordered:!1,className:m.datePicker,disabled:r,format:"L",onChange:c,showToday:!1,suffixIcon:(0,x.jsx)(v.A,{}),value:s}),(0,x.jsx)(h.A,{size:"large",bordered:!1,value:s.hour(),onChange:f,children:l.map((e=>(0,x.jsxs)(h.A.Option,{value:e,children:[e%24,"hs"]},e)))})]})]})}var f=a(52603),j=a(40989),g=a(75485),b=a(18465),C=a.n(b);const A={outer:"ScrollRadioGroup_outer__le1zO",inner:"ScrollRadioGroup_inner__OtSnf",leftScroll:"ScrollRadioGroup_leftScroll__93AE2",rightScroll:"ScrollRadioGroup_rightScroll__jam2v"},_=C().bind(A),k=-50,R=5;function y(e){let{children:r,...a}=e;const s=(0,o.useRef)(),[n,t]=(0,o.useState)(!1),[i,d]=(0,o.useState)(!1),c=(0,o.useCallback)((()=>{if(!s.current)return;const{scrollLeft:e,scrollWidth:r,offsetWidth:a}=s.current;t(e>R),d(r-a-e>R)}),[]);(0,o.useEffect)(c,[c]);const u=(0,o.useCallback)((e=>{var r,a,o;if(!s.current)return;const n=(null===e||void 0===e||null===(r=e.target)||void 0===r||null===(a=r.parentNode)||void 0===a||null===(o=a.parentNode)||void 0===o?void 0:o.offsetLeft)||0;requestAnimationFrame((()=>{s.current.scrollLeft=Math.max(n+k,0)}))}),[]);return(0,x.jsx)("div",{className:_({outer:!0,leftScroll:n,rightScroll:i}),children:(0,x.jsx)("div",{className:A.inner,onClick:u,onScroll:c,ref:s,children:(0,x.jsx)(l.Ay.Group,{buttonStyle:"solid",size:"large",...a,children:r})})})}var I=a(93954),N=a(17592),S=a(60446),w=a.n(S),F=a(39194);const L={wrapper:"ReservationGroupModal_wrapper__Zz0UE",footer:"ReservationGroupModal_footer__84trD",heading:"ReservationGroupModal_heading__XmfZc",changeReasonHint:"ReservationGroupModal_changeReasonHint__wRHqj",cancelRadioGroup:"ReservationGroupModal_cancelRadioGroup__R1qM2"};var T=a(24095);function E(e){var r,a;let{initialFrom:u,initialCourtId:v,reservation:h,onFinish:m,setReservations:b}=e;const{config:{visibleHours:C},courts:A}=(0,o.useContext)(N.v),[_,k]=(0,o.useState)((null===h||void 0===h?void 0:h.text)||""),[R,S]=(0,o.useState)((()=>(null===h||void 0===h?void 0:h.from)||u.startOf("day"))),[E,O]=(0,o.useState)((()=>(null===h||void 0===h?void 0:h.to)||u.add(1,"day").startOf("day"))),[B,M]=(0,o.useState)((null===h||void 0===h?void 0:h.courtId)||v),P=(0,o.useRef)({}),[q,G]=(0,T.g)(c.AI,b),[D,z]=(0,T.g)(c.iU,b),H=q.loading||D.loading,Q=h&&(h.from!==R||h.to!==E||h.text!==_||h.courtId!==B),U=(0,o.useMemo)((()=>{var e,r;let a=(null===(e=q.error)||void 0===e?void 0:e.unavailableReservations)||(null===(r=D.error)||void 0===r?void 0:r.unavailableReservations);return a&&(a=a.map((e=>{let{courtId:r,from:a,to:o}=e;return{courtId:r,from:w()(a),to:w()(o)}}))),a}),[null===(r=D.error)||void 0===r?void 0:r.unavailableReservations,null===(a=q.error)||void 0===a?void 0:a.unavailableReservations]),W=(0,o.useCallback)((e=>{k(e.target.value)}),[]),V=(0,o.useCallback)((e=>{M(e.target.value)}),[]),Z=(0,o.useCallback)((()=>{var e;const r=()=>{h?z({path:{groupId:h.groupId}},{reservations:[{courtId:B,from:R,to:E}],text:_},(()=>{s.Ay.success("Reserva exitosa"),m()})):G(null,{reservations:[{courtId:B,from:R,to:E}],text:_,type:j.P.DISABLE},(()=>{s.Ay.success("Reserva exitosa"),m()}))};let a;R.hour()<=C[0]?a=R.hour(C[0]):R.hour()>=C[1]&&(a=R.add(1,"day").hour(C[0])),null!==(e=a)&&void 0!==e&&e.isSameOrAfter(E,"hour")?n.A.error({icon:!1,title:"Reserva no permitida",width:530,centered:!0,content:"El Reserva est\xe1 fuera del per\xedodo mostrado."}):n.A.confirm({icon:!1,title:"\xbfRealmente bloquear?",okText:"Sperren",okType:"danger",width:530,centered:!0,content:"Las reservas existentes que entren en conflicto con el bloqueo ser\xe1n canceladas autom\xe1ticamente. Los titulares de las reservas ser\xe1n informados de ello v\xeda correo electr\xf3nico.",onOk:r})}),[B,R,m,z,G,_,h,E,C]),K=(0,o.useCallback)((()=>{z({path:{groupId:h.groupId}},{reservations:[]},(()=>{s.Ay.success("Bloqueo levantado"),m()}))}),[m,z,null===h||void 0===h?void 0:h.groupId]);return(0,o.useEffect)((()=>{P.current.post===q.error&&P.current.patch===D.error||(P.current.post=q.error,P.current.patch=D.error,U&&n.A.error({centered:!0,title:"Error de bloqueo",content:(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{children:"Ya existe un bloqueo para los siguientes periodos:"}),(0,x.jsx)("ul",{children:U.map((e=>{let{courtId:r,from:a,to:o}=e;return(0,x.jsxs)("li",{children:[a.format("dd[\xa0]L,[\xa0]H[\xa0][Uhr]")," bis ",o.format("dd[\xa0]L,[\xa0]H[\xa0][Uhr]"),", ",(0,F.B4)(A,r)]},a)}))})]})}))}),[A,D.error,q.error,U]),q.error&&!q.error.unavailableReservations||D.error&&!D.error.unavailableReservations?(0,x.jsx)(n.A,{title:"Error de bloqueo",visible:!0,centered:!0,onCancel:m,onOk:m,footer:(0,x.jsx)("div",{className:L.footer,children:(0,x.jsx)(t.A,{onClick:m,children:"Cancelar"})}),children:(0,x.jsx)("div",{className:L.wrapper,children:(0,x.jsx)(f.Y,{})})}):(0,x.jsx)(n.A,{title:"Espacio de bloque",visible:!0,width:530,centered:!0,onCancel:m,onOk:m,footer:H?(0,x.jsx)(I.E,{loading:!0,text:"Espere por favor..."}):(0,x.jsxs)("div",{className:L.footer,children:[(0,x.jsx)(t.A,{onClick:m,children:"Cancelar"}),h&&(0,x.jsx)(t.A,{type:"primary",onClick:K,children:"Eliminar bloqueo"}),(0,x.jsx)(t.A,{disabled:h&&!Q,type:"danger",onClick:Z,children:"Bloqueo"})]}),children:(0,x.jsxs)("div",{className:L.wrapper,children:[(0,x.jsx)(g.N,{court:(0,x.jsx)(y,{disabled:H,onChange:V,value:B,children:A.map((e=>{let{courtId:r,name:a}=e;return(0,x.jsx)(l.Ay.Button,{value:r,children:a},r)}))}),date:(0,x.jsx)(p,{disabled:H,from:R,to:E,onFromChange:S,onToChange:O})}),(0,x.jsx)(i.A,{layout:"vertical",children:(0,x.jsxs)(i.A.Item,{label:"Grund der Sperrung",children:[(0,x.jsx)(d.A,{disabled:H,onChange:W,placeholder:"Kein Grund",value:_}),(0,x.jsx)("div",{className:L.changeReasonHint,children:"Las reservas existentes ser\xe1n canceladas."})]})})]})})}var O=a(86565);function B(e){let{onClose:r}=e;return(0,x.jsx)(n.A,{title:"Se requiere inicio de sesion",visible:!0,width:400,centered:!0,onCancel:r,onOk:r,footer:null,children:(0,x.jsx)(O.Q,{})})}var M=a(24700),P=a(39470),q=a(67407),G=a(98617),D=a(61966),z=a(75337),H=a(49613);const Q={wrapper:"RepeatReservationForm_wrapper__32G50",dates:"RepeatReservationForm_dates__UWvuQ",extra:"RepeatReservationForm_extra__DEIZK",unchecked:"RepeatReservationForm_unchecked__BLlpi",date:"RepeatReservationForm_date__353n5",dateButton:"RepeatReservationForm_dateButton__Tdwo+",danger:"RepeatReservationForm_danger__nNm39",buttons:"RepeatReservationForm_buttons__KePjR"};var U=a(60665);const W=C().bind(Q),V={1:"Diario",7:"Semanal",14:"Bi-Semanal"};function Z(e){let{courtId:r,currentReservations:a,defaultAddCount:s=2,disabled:n=!1,from:i,onChange:d,repeatValuesMap:c=V,to:u,unavailableReservations:v}=e;const{user:h}=(0,o.useContext)(H.I),{config:{reservationDaysInAdvance:m}}=(0,o.useContext)(N.v),p=(0,U.z)("hour"),[f,j]=(0,o.useState)(0),[g,b]=(0,o.useState)([]),[C,A]=(0,o.useState)([]),_=(0,o.useRef)({}),k=(0,o.useCallback)((e=>({courtId:r,from:e,to:e.hour(u.hour()||24)})),[r,u]),R=(0,o.useCallback)((e=>!(null!==h&&void 0!==h&&h.admin)&&e.isAfter(p.add(m,"day"),"day")),[p,m,null===h||void 0===h?void 0:h.admin]),I=(0,o.useCallback)((e=>{if(!v)return!1;const r=k(e);return v.some((e=>r.courtId===e.courtId&&r.from.isSame(e.from,"hour")&&r.to.isSame(e.to,"hour")))}),[v,k]),S=(0,o.useCallback)((e=>{A((r=>{let a=e;return"function"===typeof e&&(a=e(r)),a.filter((e=>!I(e)&&!R(e)))}))}),[I,R]);(0,o.useEffect)((()=>{d(C.map(k))}),[C,d,k]),(0,o.useEffect)((()=>S((e=>e))),[S]);const w=(0,o.useCallback)((()=>{let e=[],r=[];if((null===a||void 0===a?void 0:a.length)>1){e=a.map((e=>e.from.hour(i.hour()))),e.sort(((e,r)=>e.valueOf()-r.valueOf()));let o=Number.MAX_SAFE_INTEGER;if(e.length>1)for(let r=1;r<e.length;++r){const a=e[r-1].diff(e[r],"day");o=Math.min(o,Math.abs(a))}o=o.toString();const s=Object.keys(c);s.includes(o)||(o=s[0]),j(o);const n=e[0],t=e[e.length-1],l=Math.abs(n.diff(t,"day")/o);r=[];for(let e=0;e<=l;++e)r.push(n.add(e*o,"day"))}else if(f>0)for(let a=0;a<=s;++a){const o=i.add(a*f,"day");r.push(o),e.push(o)}else e=[i],r=[i];b(r),S(e)}),[a,s,i,f,c,S]);(0,o.useEffect)((()=>{_.current.courtId===r&&_.current.currentReservations===a&&_.current.from===i&&_.current.repeatValue===f&&_.current.to===u||(_.current.courtId=r,_.current.currentReservations=a,_.current.from=i,_.current.repeatValue=f,_.current.to=u,w())}),[r,a,i,f,w,u]);const F=(0,o.useCallback)((()=>{b((e=>{const r=e[e.length-1].add(f,"day");return S((e=>[...e,r])),[...e,r]}))}),[f,S]),L=(0,o.useCallback)((e=>{const r=e.target.value;j(r)}),[]),T=(0,o.useCallback)(((e,r)=>{S((a=>{const o=a.filter((r=>!r.isSame(e,"day")));return r&&o.push(e),o.sort(((e,r)=>e.valueOf()-r.valueOf())),o}))}),[S]),E=(0,o.useMemo)((()=>g.map((e=>{const r=k(e),o=null===a||void 0===a?void 0:a.some((e=>e.from.isSame(r.from,"hour")&&e.to.isSame(r.to,"hour"))),s=C.some((r=>r.isSame(e,"day")));return{date:e,checked:s,change:!o&&(null===a||void 0===a?void 0:a.some((r=>r.from.isSame(e,"day")))),reserved:o,past:e.isBefore(p,"hour"),notAvailable:I(e),tooFarAhead:R(e),onClick:()=>T(e,!s)}}))),[I,R,a,k,T,p,C,g]);return(0,x.jsxs)("div",{className:Q.wrapper,children:[(0,x.jsx)("div",{children:(0,x.jsxs)(y,{disabled:(null===a||void 0===a?void 0:a.length)>1||n,onChange:L,value:f,children:[(0,x.jsx)(l.Ay.Button,{value:0,children:"Hoy"},0),Object.keys(c).map((e=>(0,x.jsx)(l.Ay.Button,{value:e,children:c[e]},e)))]})}),f>0&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:Q.dates,children:E.map((e=>{let{date:r,checked:a,change:o,reserved:s,past:l,notAvailable:i,tooFarAhead:d,onClick:c}=e;return(0,x.jsxs)(t.A,{className:W({dateButton:!0,unchecked:!a,danger:s&&!a||i}),disabled:!(null!==h&&void 0!==h&&h.admin)&&(l||d)||i||n,onClick:c,type:"link",icon:(null===h||void 0===h||!h.admin)&&(l||d)||i||n?(0,x.jsx)(G.A,{}):a?(0,x.jsx)(D.A,{}):(0,x.jsx)(z.A,{}),children:[(0,x.jsx)("span",{className:Q.date,children:r.format("dd[\xa0]L")}),!l&&s&&a&&(0,x.jsx)("span",{className:Q.extra,children:"Aktuell reserviert"}),!l&&s&&!a&&(0,x.jsx)("span",{className:Q.extra,children:"Wird storniert"}),!i&&l&&(0,x.jsx)("span",{className:Q.extra,children:"Bereits vergangen"}),!i&&d&&(0,x.jsx)("span",{className:Q.extra,children:"Zu weit in der Zukunft"}),!i&&o&&(0,x.jsx)("span",{className:Q.extra,children:"Wird ge\xe4ndert"}),i&&(0,x.jsx)("span",{className:Q.extra,children:"Nicht verf\xfcgbar"})]},r)}))}),(0,x.jsx)("div",{className:Q.buttons,children:(0,x.jsx)(t.A,{disabled:n,icon:(0,x.jsx)(z.A,{}),onClick:F,type:"dashed"})})]})]})}var K=a(64435);function X(e){let{disabled:r=!1,from:a,to:s,onFromChange:n,onToChange:t}=e;const{config:{visibleHours:l}}=(0,o.useContext)(N.v),i=(0,o.useMemo)((()=>(0,F.XD)(l)),[l]),d=(0,o.useMemo)((()=>i.reduce(((e,r)=>(r>=a.hour()&&e.push(r+1),e)),[])),[a,i]);(0,o.useEffect)((()=>{a.isSame(s,"hour")&&t(a.add(1,"hour"))}),[a,s,t]);const c=(0,o.useCallback)((e=>{let r=e+Math.abs(s.diff(a,"hour"));i.includes(r)||(r=i[i.length-1]+1),n(a.hour(e)),t(a.hour(r))}),[a,s,n,t,i]),u=(0,o.useCallback)((e=>{t(a.hour(e))}),[a,t]);return(0,x.jsxs)(K.A,{direction:"horizontal",size:"middle",children:[(0,x.jsx)(h.A,{bordered:!1,disabled:r,onChange:c,size:"large",value:a.hour(),children:i.map((e=>(0,x.jsxs)(h.A.Option,{value:e,children:[e,"hs"]},e)))}),(0,x.jsx)("span",{children:"hasta"}),(0,x.jsx)(h.A,{bordered:!1,disabled:r,onChange:u,size:"large",value:0===s.hour()?24:s.hour(),children:d.map((e=>(0,x.jsxs)(h.A.Option,{value:e,children:[e%24,"hs"]},e)))})]})}const Y={nameInput:"ReservationDetailsForm_nameInput__BE5wL",plain:"ReservationDetailsForm_plain__mpbQ6",datePicker:"ReservationDetailsForm_datePicker__-Ajbu"};function J(e){var r,a,s,n;let{courtId:i,currentReservations:c,disabled:h,from:m,onCourtIdChange:p,onFromChange:f,onReservationsChange:j,onTextChange:b,onToChange:C,readOnly:A,text:_,to:k,unavailableReservations:R}=e;const{courts:I}=(0,o.useContext)(N.v),{user:S}=(0,o.useContext)(H.I),[w,L]=(0,o.useState)(!1),T=(0,o.useCallback)((()=>{L(!0)}),[]),E=(0,o.useCallback)((()=>{L(!1),b(null)}),[b]),O=(0,o.useCallback)((e=>{const r=Math.abs(k.diff(m,"hour")),a=e.hour(m.hour()),o=a.add(r,"hour");f(a),C(o)}),[m,k,f,C]),B=(0,o.useCallback)((e=>{b(e.target.value)}),[b]),M=(0,o.useCallback)((e=>{p(e.target.value)}),[p]);return A?(0,x.jsx)(g.N,{court:(0,x.jsx)("div",{className:Y.plain,children:(0,F.B4)(I,i)}),date:(0,x.jsx)("div",{className:Y.plain,children:m.format("dd[\xa0]L")}),time:(0,x.jsxs)("div",{className:Y.plain,children:[m.format("H")," hs hasta ",k.format("H")," hs"]}),name:(0,x.jsx)("div",{className:Y.plain,children:(null===c||void 0===c||null===(r=c[0])||void 0===r?void 0:r.text)||(null===c||void 0===c||null===(a=c[0])||void 0===a?void 0:a.name)||S.name})}):(0,x.jsx)(g.N,{court:(0,x.jsx)(y,{disabled:h,onChange:M,value:i,children:I.map((e=>{let{courtId:r,name:a}=e;return(0,x.jsx)(l.Ay.Button,{value:r,children:a},r)}))}),date:(0,x.jsx)(u.l,{allowClear:!1,bordered:!1,className:Y.datePicker,disabled:(null===c||void 0===c?void 0:c.length)>1||h,format:"L",onChange:O,showToday:!1,suffixIcon:(0,x.jsx)(v.A,{}),value:m}),time:(0,x.jsx)(X,{disabled:h,from:m,to:k,onFromChange:f,onToChange:C}),name:w?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(d.A,{className:Y.nameInput,disabled:h,onChange:B,placeholder:"z.B. Training, ...",value:_,size:"large"}),(0,x.jsx)(t.A,{disabled:h,onClick:E,type:"link",children:"Cancelar"})]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:Y.plain,children:(0,x.jsx)("span",{children:(null===c||void 0===c||null===(s=c[0])||void 0===s?void 0:s.text)||(null===c||void 0===c||null===(n=c[0])||void 0===n?void 0:n.name)||S.name})}),S.admin&&(0,x.jsxs)(t.A,{disabled:h,onClick:T,type:"link",children:[(0,x.jsx)(q.A,{})," editar"]})]}),repeat:(0,x.jsx)(Z,{courtId:i,currentReservations:c,disabled:h,from:m,onChange:j,to:k,unavailableReservations:R})})}function $(e){var r,a;let{initialCourtId:u,initialFrom:v,initialTo:h,reservation:m,onFinish:p,setReservations:g}=e;const{courts:b,templates:{reservationTos:C}}=(0,o.useContext)(N.v),{user:A}=(0,o.useContext)(H.I),[_,k]=(0,o.useState)(""),[R,y]=(0,o.useState)(null),[S,E]=(0,o.useState)(null),[O,B]=(0,o.useState)((null===m||void 0===m?void 0:m.from)||v),[q,G]=(0,o.useState)((null===m||void 0===m?void 0:m.to)||h),[D,z]=(0,o.useState)((null===m||void 0===m?void 0:m.courtId)||u),Q=(0,o.useRef)({}),[U,W]=(0,o.useState)([]),[V,Z]=(0,T.g)(c.Mf,W),[K,X]=(0,T.g)(c.AI,g),[Y,$]=(0,T.g)(c.iU,g),ee=V.loading||K.loading||Y.loading,re=m&&A.admin&&(null===m||void 0===m?void 0:m.userId)!==A.userId,ae=A.admin||!m||m.userId===A.userId,oe=(0,o.useMemo)((()=>null===S||void 0===S?void 0:S.filter((e=>!U.some((r=>r.from.isSame(e.from,"hour")&&r.to.isSame(e.to,"hour")))))),[S,U]),se=(0,o.useMemo)((()=>S&&U.filter((e=>!S.some((r=>r.from.isSame(e.from,"hour")&&r.to.isSame(e.to,"hour")))))),[S,U]),ne=!(!U||!R),te=(0,o.useMemo)((()=>{var e,r;let a=(null===(e=K.error)||void 0===e?void 0:e.unavailableReservations)||(null===(r=Y.error)||void 0===r?void 0:r.unavailableReservations);return a&&(a=a.map((e=>{let{courtId:r,from:a,to:o}=e;return{courtId:r,from:w()(a),to:w()(o)}}))),a}),[null===(r=Y.error)||void 0===r?void 0:r.unavailableReservations,null===(a=K.error)||void 0===a?void 0:a.unavailableReservations]);(0,o.useEffect)((()=>{null!==m&&void 0!==m&&m.groupId&&Z({query:{"group-id":null===m||void 0===m?void 0:m.groupId}})}),[m,Z]);const le=(0,o.useCallback)((e=>{k(e.target.value)}),[]),ie=(0,o.useCallback)((()=>{n.A.confirm({icon:!1,okText:"Aceptar",width:530,centered:!0,content:(0,x.jsx)("div",{dangerouslySetInnerHTML:{__html:C.body}}),onOk:()=>{X(null,{reservations:S,text:R,type:j.P.NORMAL},(()=>{s.Ay.success("Reserva exitosa"),p()}))}})}),[p,X,S,C,R]),de=(0,o.useCallback)((()=>{n.A.confirm({title:"\xbfRealmente quiere guardar?",icon:(0,x.jsx)(P.A,{}),centered:!0,content:(0,x.jsxs)("div",{className:L.wrapper,children:[oe.length>0&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:L.heading,children:"Nuevas fechas"}),(0,x.jsx)("ul",{children:oe.map((e=>{let{courtId:r,from:a,to:o}=e;return(0,x.jsxs)("li",{children:[a.format("dd[\xa0]L"),", ",a.hour(),"\xa0bis\xa0",o.hour(),"\xa0hs, ",(0,F.B4)(b,r)]},a)}))})]}),se.length>0&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:L.heading,children:"Cancelar"}),(0,x.jsx)("ul",{children:se.map((e=>{let{courtId:r,from:a,to:o}=e;return(0,x.jsxs)("li",{children:[a.format("dd[\xa0]L"),", ",a.hour(),"\xa0bis\xa0",o.hour(),"\xa0hs, ",(0,F.B4)(b,r)]},a)}))})]}),ne&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:L.heading,children:"Cambios"}),(0,x.jsx)("ul",{children:(0,x.jsxs)("li",{children:["Name: ",(0,x.jsx)("strong",{children:R})]})})]})]}),okText:"Confirmar",okType:"danger",cancelText:"Cancelar",onOk:()=>{$({path:{groupId:m.groupId}},{reason:re?_:void 0,reservations:S,text:R},(()=>{s.Ay.success("Guardado con \xe9xito"),p()}))}})}),[re,se,_,ne,b,oe,p,$,m,S,R]),ce=(0,o.useCallback)((()=>{let e="single";const r=r=>e=r.target.value,a=()=>{const r={path:{groupId:m.groupId}};let a;a="single"===e?U.filter((e=>!e.from.isSame(m.from,"day"))):"allActive"===e?U.filter((e=>e.from.isBefore(w()(),"hour"))):[],$(r,{reason:re?_:void 0,reservations:a},(()=>{s.Ay.success("Cancelaci\xf3n exitosa"),p()}))};U.length<=1?a():n.A.confirm({title:"Cancelar citas",icon:(0,x.jsx)(P.A,{}),centered:!0,content:(0,x.jsxs)(l.Ay.Group,{className:L.cancelRadioGroup,onChange:r,defaultValue:e,children:[(0,x.jsx)(l.Ay,{value:"single",children:"solo esta cita"}),(0,x.jsx)("ul",{children:(0,x.jsxs)("li",{children:[m.from.format("dd[\xa0]L"),", ",m.from.hour(),"\xa0bis\xa0",m.to.hour(),"\xa0hs, ",(0,F.B4)(b,m.courtId)]},m.from)}),(0,x.jsx)(l.Ay,{value:"allActive",children:"Todas las citas abiertas"}),(0,x.jsx)("ul",{children:U.filter((e=>!e.from.isBefore(w()(),"hour"))).map((e=>{let{courtId:r,from:a,to:o}=e;return(0,x.jsxs)("li",{children:[a.format("dd[\xa0]L"),", ",a.hour(),"\xa0bis\xa0",o.hour(),"\xa0hs, ",(0,F.B4)(b,r)]},a)}))}),(null===A||void 0===A?void 0:A.admin)&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(l.Ay,{value:"all",children:"Todas las citas"}),(0,x.jsx)("ul",{children:U.map((e=>{let{courtId:r,from:a,to:o}=e;return(0,x.jsxs)("li",{children:[a.format("dd[\xa0]L"),", ",a.hour(),"\xa0bis\xa0",o.hour(),"\xa0hs, ",(0,F.B4)(b,r)]},a)}))})]})]}),okText:"Aceptar",okType:"danger",cancelText:"Cancelar",onOk:a})}),[re,_,b,U,p,$,m,null===A||void 0===A?void 0:A.admin]);return(0,o.useEffect)((()=>{var e,r;if(Q.current.post===K.error&&Q.current.patch===Y.error)return;Q.current.post=K.error,Q.current.patch=Y.error;const a=(null===(e=K.error)||void 0===e?void 0:e.message)||(null===(r=Y.error)||void 0===r?void 0:r.message);if(te)n.A.error({centered:!0,title:"Reserva fallida",content:(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{children:"Las siguientes fechas no est\xe1n disponibles:"}),(0,x.jsx)("ul",{children:te.map((e=>{let{courtId:r,from:a,to:o}=e;return(0,x.jsxs)("li",{children:[a.format("dd[\xa0]L"),", ",a.hour(),"\xa0bis\xa0",o.hour(),"\xa0hs, ",(0,F.B4)(b,r)]},a)}))})]})});else if("too many active reservations"===a){var o,s,t,l;const e=(null===(o=K.error)||void 0===o?void 0:o.value)||(null===(s=Y.error)||void 0===s?void 0:s.value),r=(null===(t=K.error)||void 0===t?void 0:t.max)||(null===(l=Y.error)||void 0===l?void 0:l.max),a=Math.abs(e-r);n.A.error({centered:!0,title:"L\xedmite de reserva alcanzado",content:(0,x.jsxs)("div",{children:[(null===S||void 0===S?void 0:S.length)>a?(0,x.jsxs)("p",{children:["Por favor elimine al menos",(0,x.jsx)("strong",{children:a})," Eventos."]}):(0,x.jsx)("p",{children:"Actualmente no puede reservar m\xe1s citas."}),(0,x.jsxs)("p",{children:["Pueden ser un maximo de ",r," Las reservas deben hacerse con anticipaci\xf3n. No se tendr\xe1n en cuenta las citas anteriores."]})]})})}}),[b,null===S||void 0===S?void 0:S.length,K.error,Y.error,te]),V.error||K.error&&!K.error.unavailableReservations&&"too many active reservations"!==K.error.message||Y.error&&!Y.error.unavailableReservations&&"too many active reservations"!==Y.error.message?(0,x.jsx)(n.A,{title:"reserva",visible:!0,centered:!0,onCancel:p,onOk:p,footer:(0,x.jsx)("div",{className:L.footer,children:(0,x.jsx)(t.A,{onClick:p,children:"Cancelar"})}),children:(0,x.jsx)("div",{className:L.wrapper,children:(0,x.jsx)(f.Y,{})})}):(0,x.jsx)(n.A,{visible:!0,width:530,centered:!0,onCancel:p,onOk:p,footer:ee?(0,x.jsx)(I.E,{loading:!0,text:"Espere por favor..."}):(0,x.jsxs)("div",{className:L.footer,children:[(0,x.jsx)(t.A,{onClick:p,children:"Cerrar"}),ae&&(m?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(t.A,{type:"danger",onClick:ce,disabled:re&&!_,children:"Cancelar reserva"}),(0,x.jsx)(t.A,{type:"primary",onClick:de,disabled:!(null!==oe&&void 0!==oe&&oe.length||null!==se&&void 0!==se&&se.length||ne)||re&&!_,children:"Guardar"})]}):(0,x.jsx)(t.A,{disabled:!(null!==oe&&void 0!==oe&&oe.length),type:"primary",onClick:ie,children:"Reservas"}))]}),children:(0,x.jsxs)("div",{className:L.wrapper,children:[V.loading?(0,x.jsx)(M.c,{visible:!0,spin:!0,centered:!0,large:!0}):(0,x.jsx)(J,{courtId:D,currentReservations:U,disabled:ee,from:O,onCourtIdChange:z,onFromChange:B,onReservationsChange:E,onTextChange:y,onToChange:G,readOnly:!ae,text:R,to:q,unavailableReservations:te}),re&&(0,x.jsx)(i.A,{layout:"vertical",children:(0,x.jsxs)(i.A.Item,{label:"La razon del cambio",required:!0,children:[(0,x.jsx)(d.A.TextArea,{autoSize:!0,disabled:ee,onChange:le,placeholder:"Necesario",required:!0,value:_}),(0,x.jsx)("div",{className:L.changeReasonHint,children:"El titular de la reserva ser\xe1 informado de los cambios y el motivo de los mismos mediante correo electr\xf3nico."})]})})]})})}var ee=a(13159);const re={buttons:"VerifyMailModal_buttons__64oQR"};var ae=a(59557);function oe(e){let{onClose:r}=e;const{user:a}=(0,o.useContext)(H.I),s=(0,ae.W6)(),l=(0,o.useCallback)((()=>{s.push("/profile")}),[s]),i=(0,o.useCallback)((()=>{s.push("/verify-mail/send")}),[s]);return(0,x.jsx)(n.A,{title:"Correo electr\xf3nico no verificado",visible:!0,centered:!0,width:580,onCancel:r,onOk:r,footer:null,children:(0,x.jsx)(ee.Ay,{status:"warning",title:"Por favor confirme su direcci\xf3n de correo electr\xf3nico",extra:(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{children:["Haga clic en el enlace de confirmaci\xf3n enviado al correo ",(0,x.jsx)("strong",{children:null===a||void 0===a?void 0:a.mail})]}),(0,x.jsxs)("div",{className:re.buttons,children:[(0,x.jsx)(t.A,{type:"primary",onClick:i,children:"Reenviar enlace de confirmaci\xf3n"}),(0,x.jsx)(t.A,{type:"link",onClick:l,children:"Cambiar direcci\xf3n de correo electr\xf3nico"})]})]})})})}function se(e){const{user:r}=(0,o.useContext)(H.I),{onFinish:a,reservation:s,type:n}=e;return r?r.verified?(null===s||void 0===s?void 0:s.type)===j.P.DISABLE||n===j.P.DISABLE?(0,x.jsx)(E,{...e}):(0,x.jsx)($,{...e}):(0,x.jsx)(oe,{onClose:a}):(0,x.jsx)(B,{onClose:a})}},60665:(e,r,a)=>{a.d(r,{z:()=>l});var o=a(65043),s=a(60446),n=a.n(s);const t=6e4;function l(e){const[r,a]=(0,o.useState)((()=>n().tz()));return(0,o.useEffect)((()=>{const o=setInterval((()=>{const o=n().tz();r.isSame(o,e)||a(o)}),t);return()=>clearInterval(o)}),[r,e]),r}},86565:(e,r,a)=>{a.d(r,{Q:()=>j});var o=a(53593),s=a(92135),n=a(25389),t=a(78186),l=a(89421),i=a(75388),d=a(98617),c=a(65043),u=a(62582),v=a(93954),h=a(49613),m=a(22768);const x={loginButton:"LoginForm_loginButton__Tob1Q",forgotLink:"LoginForm_forgotLink__PPl5y",registerItem:"LoginForm_registerItem__KHQVO"};var p=a(24095),f=a(70579);function j(){const{autoLoginState:e,setUser:r,setRememberLogin:a}=(0,c.useContext)(h.I),[j,g]=(0,p.g)(m.cx,r),b=j.loading||e.loading,C=j.error?"error":void 0,A=(0,c.useCallback)((e=>{let{mail:r,password:o,rememberLogin:s}=e;a(s),g(null,{type:"plain",mail:r,password:o})}),[g,a]);return(0,f.jsxs)(o.A,{layout:"vertical",onFinish:A,children:[j.error&&(0,f.jsx)(o.A.Item,{children:(0,f.jsx)(s.A,{type:"error",message:"Error en el inicio de sesion."})}),(0,f.jsx)(o.A.Item,{name:"mail",rules:[{required:!0,message:"El correo electr\xf3nico es requerido"}],validateStatus:C,children:(0,f.jsx)(n.A,{autoComplete:"email",prefix:(0,f.jsx)(i.A,{style:{color:"#aaa"}}),placeholder:"Correo electr\xf3nico",disabled:b})}),(0,f.jsx)(o.A.Item,{name:"password",rules:[{required:!0,message:"La contrase\xf1a es requerida"}],validateStatus:C,children:(0,f.jsx)(n.A.Password,{autoComplete:"current-password",prefix:(0,f.jsx)(d.A,{style:{color:"#aaa"}}),placeholder:"Contrase\xf1a",disabled:b})}),(0,f.jsxs)(o.A.Item,{children:[(0,f.jsx)(o.A.Item,{name:"rememberLogin",valuePropName:"checked",noStyle:!0,children:(0,f.jsx)(t.A,{disabled:b,children:"Recordar contrase\xf1a"})}),(0,f.jsx)(u.N_,{className:x.forgotLink,to:"/reset-password",children:"Olvid\xe9 mi contrase\xf1a"})]}),(0,f.jsx)(o.A.Item,{children:(0,f.jsx)(l.A,{type:"primary",htmlType:"submit",className:x.loginButton,disabled:b,children:(0,f.jsx)(v.E,{loading:b,text:b?"Iniciando...":"Iniciar sesion"})})}),(0,f.jsx)(o.A.Item,{className:x.registerItem,children:(0,f.jsx)(u.N_,{to:"/register",children:"Registrarse gratis"})})]})}}}]);
//# sourceMappingURL=759.f8627656.chunk.js.map